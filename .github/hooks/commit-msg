#!/bin/sh

# git config core.hooksPath .githooks

shopt -s nocasematch
msg_file=$1
msg=$(cat "$msg_file")

declare -A regex_sections=(
  ["âœ¨"]="^(âœ¨|æ–°å¢ž|feat)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["ðŸ› ï¸"]="^(ðŸ› ï¸|ä¿®å¤|fix)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["ðŸ“š"]="^(ðŸ“š|æ–‡æ¡£|docs)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["ðŸŽ¨"]="^(ðŸŽ¨|é£Žæ ¼|style)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["ðŸš€"]="^(ðŸš€|æ€§èƒ½|perf)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["âš™ï¸"]="^(âš™ï¸|é…ç½®|config)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["ðŸŒ"]="^(ðŸŒ|è¯­è¨€|i18n)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
  ["â™»ï¸"]="^(â™»ï¸|æ‚é¡¹|chore)(\\(.+\\))?([ ]|[:ï¼š][ ]?)"
)


for category in "${!regex_sections[@]}"; do
  regex=${regex_sections[$category]}
  if [[ $msg =~ $regex ]]; then
    clean_msg=$(echo "$msg" | sed -E "s/$regex/ /I")
    echo "$category $clean_msg" > "$msg_file"
    exit 0
  fi
done